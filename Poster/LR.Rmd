---
title: "Learning Rates on Total and Sub Scores for HD and SHAM groups"
output:
  html_document:
    df_print: paged
  pdf_document: default
geometry: margin=1cm
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.width=12, fig.height=6) 
knitr::opts_chunk$set(fig.pos = 'H')
```
```{r libraies_data_param, include = FALSE}

library(dplyr)
library(ggplot2)
library(stats) #akaike AIC
library(SciViews) #for ln function
library(ggpubr)
library(grid)
library(rstatix)
library(gghalves)

```
```{r param, include = FALSE}
couleurs_poster = c("#0073C2FF","#A73030FF")
couleurs_alpha = c("#0073C266","#A7303099")
```
```{r data, include = FALSE}
data_long = read.csv("E:\\SpaceFortress\\Poster\\Data\\data_long_HD_SHAM.csv")
data_wide = read.csv("E:\\SpaceFortress\\Poster\\Data\\data_wide_HD_SHAM.csv") #here insert the data_long path
data_wide$Group=factor(data_wide$Group,levels=c("SHAM","STIMHD"))
data_long$Group=factor(data_long$Group,levels=c("SHAM","STIMHD"))
```
## Akaike's information Criterion (AIC) 

```{r AIC_TotalScore, include = FALSE}
#**Total Score** AIC  (choisir le plus faible) : 
fit_ln=lm(TotalScore~ln(D),data=data_long) #fit_all_lin=lm(TotalScore~D,data=data_long)
fit_lin=lm(TotalScore~D,data=data_long)
aic_ln_total = AIC(fit_ln)
aic_lin_total = AIC(fit_lin)
```
```{r AIC_FotressScore, include = FALSE}
#**Fortress Score** AIC  (choisir le plus faible) : 
fit_ln=lm(Fortress~ln(D),data=data_long)
fit_lin=lm(Fortress~D,data=data_long)
aic_ln_fortress = AIC(fit_ln)
aic_lin_fotress = AIC(fit_lin)
```
```{r AIC_FlightScore, include = FALSE}
#**Flight Score** AIC  (choisir le plus faible) : 
fit_ln=lm(Flight~ln(D),data=data_long) 
fit_lin=lm(Flight~D,data=data_long)
aic_ln_flight = AIC(fit_ln)
aic_lin_flight= AIC(fit_lin)
```
```{r AIC_BonusScore, include = FALSE}
#**Bonus Score** AIC  (choisir le plus faible) : 
fit_ln=lm(Bonus~ln(D),data=data_long) 
fit_lin=lm(Bonus~D,data=data_long)
aic_ln_bonus = AIC(fit_ln)
aic_lin_bonus = AIC(fit_lin)
```
```{r AIC_MineScore, include = FALSE}
#**Mine Score** AIC  (choisir le plus faible) : 
fit_ln=lm(Mine~ln(D),data=data_long) 
fit_lin=lm(Mine~D,data=data_long)
aic_ln_mine = AIC(fit_ln)
aic_lin_mine = AIC(fit_lin)
```
Tableau des critères d'Akaike pour chaque Score avec un modèle logarithme naturel lm(Score~ln(Days)) ou un modèle linéaire Klm(Score~Days). Choisir le plus critète le plus petit.
```{r AIC_table , echo = FALSE}
aic_table= matrix(c(aic_ln_total,aic_lin_total,aic_ln_fortress,aic_lin_fotress,aic_ln_flight,
                    aic_lin_flight,aic_ln_bonus,aic_lin_bonus,aic_ln_mine,aic_lin_mine),ncol=5,byrow=F)
colnames(aic_table)=c("Total","Fortress","Flight","Bonus","Mine")
rownames(aic_table)=c("Ln","Linear")
knitr::kable(aic_table)
```
On choisit un modèle linéaire pour le score Total, ainsi que pour le Sous Score Fortress. Pour les autres, on peut choisir le modèle logarithme naturel.

## Figures des Regressions (linéaires ou ln)
### **Total Score** (linéaire)
```{r plot_LR_Total,echo=F,fig.align = "center"}
fit_SHAM=lm(TotalScore~D,data=filter(data_long,Group=="SHAM"))
fit_HD=lm(TotalScore~D,data=filter(data_long,Group=="STIMHD"))

eq_SHAM=paste0("y= ",round(coef(fit_SHAM)[1])," + ",round(coef(fit_SHAM)[2]),"*x     ")
eq_HD=paste0("y= ",round(coef(fit_HD)[1])," + ",round(coef(fit_HD)[2]),"*x")
grob_SHAM=grobTree(textGrob(eq_SHAM,x=0.77,y=0.17,hjust=0,gp=gpar(col="#868686FF")),gp=gpar(fontsize=15))
grob_HD=grobTree(textGrob(eq_HD,x=0.77,y=0.117,hjust=0,gp=gpar(col="#A73030FF")),gp=gpar(fontsize=15))

plot_LR_total=ggplot(data_long,aes(D,TotalScore,color=Group,shape=Group))+theme_pubr()+
  scale_x_continuous(sec.axis=sec_axis(~.,breaks=c(1,4.5,8.5,10.5),labels=c("Référence","Entraînement & stimulation","Court terme","Long terme")),breaks=1:11)+
  geom_rect(data=data_long,aes(xmin=1.5,xmax=7.5,ymin=-Inf,ymax=+Inf),fill="grey",alpha=0.01,inherit.aes = FALSE)+
  geom_vline(xintercept = seq(1.5,7.5,2),linetype="dotted",alpha=0.5)+geom_vline(xintercept =9.5,alpha=0.3,linetype="solid",size=0.5)+
  stat_smooth(method=lm,formula=y~x,se=FALSE,show.legend = FALSE )+
  stat_summary(geom="point",fun="mean",size=3 ,position=position_dodge(width=0.5))+
  labs(x="Game Session",y="Total Score")+
  stat_summary(fun.data = "mean_se", fun.args = list(mult = 1),size=1 ,show.legend = FALSE,geom="errorbar",width=0.1 ,position=position_dodge(width=0.5))+
  scale_y_continuous(breaks =seq(0, 15000, by = 2500))+
  scale_colour_manual(values=couleurs_poster)+
  annotation_custom(grob_SHAM)+ annotation_custom(grob_HD)+
  theme(legend.position = c(0.7,0.15),legend.background = element_rect(fill=NA),legend.title = element_blank(),
        axis.title = element_text(size=18,margin=0.1),legend.text = element_text(size=16),text=element_text(size=16))+
  annotate("text",x=c(1,2.5,4.5,6.5,8.5,10.5),y=Inf,vjust=1.5,label=c("D1","D2","D3","D4","D5","D15"),size=5)
plot_LR_total
```
```{r plot_LR_Fortress,include=F}
fit_SHAM=lm(Fortress~D,data=filter(data_long,Group=="SHAM"))
fit_HD=lm(Fortress~D,data=filter(data_long,Group=="STIMHD"))

eq_SHAM=paste0("y= ",round(coef(fit_SHAM)[1])," + ",round(coef(fit_SHAM)[2]),"*x     ")
eq_HD=paste0("y= ",round(coef(fit_HD)[1])," + ",round(coef(fit_HD)[2]),"*x")
grob_SHAM=grobTree(textGrob(eq_SHAM,x=0.67,y=0.17,hjust=0,gp=gpar(col="#868686FF")),gp=gpar(fontsize=10))
grob_HD=grobTree(textGrob(eq_HD,x=0.67,y=0.117,hjust=0,gp=gpar(col="#A73030FF")),gp=gpar(fontsize=10))

plot_LR_fortress=ggplot(data_long,aes(D,Fortress,color=Group,shape=Group))+theme_pubr()+
  scale_x_continuous(sec.axis=sec_axis(~.,breaks=c(1,4.5,8.5,10.5),labels=c("Référence","Entraînement & stimulation","Court terme","Long terme")),breaks=1:11)+
  geom_rect(data=data_long,aes(xmin=1.5,xmax=7.5,ymin=-Inf,ymax=+Inf),fill="grey",alpha=0.01,inherit.aes = FALSE)+geom_vline(xintercept =seq(1.5,7.5,2),linetype="dotted",alpha=0.5)+geom_vline(xintercept=9.5,alpha=0.3,linetype="solid",size=0.5)+
  stat_smooth(method=lm,formula=y~x,se=FALSE,show.legend = FALSE )+
  stat_summary(geom="point",fun="mean",size=3 ,position=position_dodge(width=0.5))+
  labs(x="Game Session",y="Fortress Score")+
  stat_summary(fun.data = "mean_se", fun.args = list(mult = 1),size=1 ,show.legend = FALSE,geom="errorbar",width=0.1 ,position=position_dodge(width=0.5))+
  scale_y_continuous(breaks =seq(0, 15000, by = 2500))+
  scale_colour_manual(values=couleurs_poster)+
  annotation_custom(grob_SHAM)+ annotation_custom(grob_HD)+
  theme(legend.position = c(0.55,0.15),legend.background = element_rect(fill=NA),legend.title = element_blank(),
        axis.title = element_text(size=18,margin=0.1),legend.text = element_text(size=10),text=element_text(size=10))+
  annotate("text",x=c(1,2.5,4.5,6.5,8.5,10.5),y=Inf,vjust=1.5,label=c("D1","D2","D3","D4","D5","D15"),size=5)
```
```{r plot_LR_Flight,include=F}
fit_SHAM=lm(Flight~ln(D),data=filter(data_long,Group=="SHAM"))
fit_HD=lm(Flight~ln(D),data=filter(data_long,Group=="STIMHD"))

eq_SHAM=paste0("y= ",round(coef(fit_SHAM)[1])," + ",round(coef(fit_SHAM)[2]),"*ln(x)     ")
eq_HD=paste0("y= ",round(coef(fit_HD)[1])," + ",round(coef(fit_HD)[2]),"*ln(x)")
grob_SHAM=grobTree(textGrob(eq_SHAM,x=0.67,y=0.17,hjust=0,gp=gpar(col="#868686FF")),gp=gpar(fontsize=10))
grob_HD=grobTree(textGrob(eq_HD,x=0.67,y=0.117,hjust=0,gp=gpar(col="#A73030FF")),gp=gpar(fontsize=10))

plot_LR_Flight=ggplot(data_long,aes(D,Flight,color=Group,shape=Group))+theme_pubr()+
  scale_x_continuous(sec.axis=sec_axis(~.,breaks=c(1,4.5,8.5,10.5),labels=c("Référence","Entraînement & stimulation","Court terme","Long terme")),breaks=1:11)+
  geom_rect(data=data_long,aes(xmin=1.5,xmax=7.5,ymin=-Inf,ymax=+Inf),fill="grey",alpha=0.01,inherit.aes = FALSE)+
  geom_vline(xintercept = seq(1.5,7.5,2),linetype="dotted",alpha=0.5)+geom_vline(xintercept =9.5,alpha=0.3,linetype="solid",size=0.5)+
  stat_smooth(method=lm,formula=y~ln(x),se=FALSE,show.legend = FALSE )+
  stat_summary(geom="point",fun="mean",size=3 ,position=position_dodge(width=0.5))+
  labs(x="Game Session",y="Flight Score")+
  stat_summary(fun.data = "mean_se", fun.args = list(mult = 1),size=1 ,show.legend = FALSE,geom="errorbar",width=0.1 ,position=position_dodge(width=0.5))+
  scale_y_continuous(breaks =seq(0, 15000, by = 2500))+
  scale_colour_manual(values=couleurs_poster)+
  annotation_custom(grob_SHAM)+ annotation_custom(grob_HD)+
  theme(legend.position = c(0.55,0.15),legend.background = element_rect(fill=NA),legend.title = element_blank(),
        axis.title = element_text(size=18,margin=0.1),legend.text = element_text(size=10),text=element_text(size=10))+
  annotate("text",x=c(1,2.5,4.5,6.5,8.5,10.5),y=Inf,vjust=1.5,label=c("D1","D2","D3","D4","D5","D15"),size=5)
```
```{r plot_LR_Bonus,include=F}
fit_SHAM=lm(Bonus~ln(D),data=filter(data_long,Group=="SHAM"))
fit_HD=lm(Bonus~ln(D),data=filter(data_long,Group=="STIMHD"))

eq_SHAM=paste0("y= ",round(coef(fit_SHAM)[1])," + ",round(coef(fit_SHAM)[2]),"*ln(x)     ")
eq_HD=paste0("y= ",round(coef(fit_HD)[1])," + ",round(coef(fit_HD)[2]),"*ln(x)")
grob_SHAM=grobTree(textGrob(eq_SHAM,x=0.67,y=0.17,hjust=0,gp=gpar(col="#868686FF")),gp=gpar(fontsize=10))
grob_HD=grobTree(textGrob(eq_HD,x=0.67,y=0.117,hjust=0,gp=gpar(col="#A73030FF")),gp=gpar(fontsize=10))

plot_LR_Bonus=ggplot(data_long,aes(D,Bonus,color=Group,shape=Group))+theme_pubr()+
  scale_x_continuous(sec.axis=sec_axis(~.,breaks=c(1,4.5,8.5,10.5),labels=c("Référence","Entraînement & stimulation","Court terme","Long terme")),breaks=1:11)+
  geom_rect(data=data_long,aes(xmin=1.5,xmax=7.5,ymin=-Inf,ymax=+Inf),fill="grey",alpha=0.01,inherit.aes = FALSE)+
  geom_vline(xintercept = seq(1.5,7.5,2),linetype="dotted",alpha=0.5)+geom_vline(xintercept =9.5,alpha=0.3,linetype="solid",size=0.5)+
  stat_smooth(method=lm,formula=y~ln(x),se=FALSE,show.legend = FALSE )+
  stat_summary(geom="point",fun="mean",size=3 ,position=position_dodge(width=0.5))+
  labs(x="Game Session",y="Bonus Score")+
  stat_summary(fun.data = "mean_se", fun.args = list(mult = 1),size=1 ,show.legend = FALSE,geom="errorbar",width=0.1 ,position=position_dodge(width=0.5))+
  scale_y_continuous(breaks =seq(0, 15000, by = 2500))+
  scale_colour_manual(values=couleurs_poster)+
  annotation_custom(grob_SHAM)+ annotation_custom(grob_HD)+
  theme(legend.position = c(0.55,0.15),legend.background = element_rect(fill=NA),legend.title = element_blank(),
        axis.title = element_text(size=18,margin=0.1),legend.text = element_text(size=10),text=element_text(size=10))+
  annotate("text",x=c(1,2.5,4.5,6.5,8.5,10.5),y=Inf,vjust=1.5,label=c("D1","D2","D3","D4","D5","D15"),size=5)
```
```{r plot_LR_Mine,include=F}
fit_SHAM=lm(Mine~ln(D),data=filter(data_long,Group=="SHAM"))
fit_HD=lm(Mine~ln(D),data=filter(data_long,Group=="STIMHD"))

eq_SHAM=paste0("y= ",round(coef(fit_SHAM)[1])," + ",round(coef(fit_SHAM)[2]),"*ln(x)     ")
eq_HD=paste0("y= ",round(coef(fit_HD)[1])," + ",round(coef(fit_HD)[2]),"*ln(x)")
grob_SHAM=grobTree(textGrob(eq_SHAM,x=0.67,y=0.17,hjust=0,gp=gpar(col="#868686FF")),gp=gpar(fontsize=10))
grob_HD=grobTree(textGrob(eq_HD,x=0.67,y=0.117,hjust=0,gp=gpar(col="#A73030FF")),gp=gpar(fontsize=10))

plot_LR_Mine=ggplot(data_long,aes(D,Mine,color=Group,shape=Group))+theme_pubr()+
  scale_x_continuous(sec.axis=sec_axis(~.,breaks=c(1,4.5,8.5,10.5),labels=c("Référence","Entraînement & stimulation","Court terme","Long terme")),breaks=1:11)+
  geom_rect(data=data_long,aes(xmin=1.5,xmax=7.5,ymin=-Inf,ymax=+Inf),fill="grey",alpha=0.01,inherit.aes = FALSE)+
  geom_vline(xintercept = seq(1.5,7.5,2),linetype="dotted",alpha=0.5)+geom_vline(xintercept =9.5,alpha=0.3,linetype="solid",size=0.5)+
  stat_smooth(method=lm,formula=y~ln(x),se=FALSE,show.legend = FALSE )+
  stat_summary(geom="point",fun="mean",size=3 ,position=position_dodge(width=0.5))+
  labs(x="Game Session",y="Mine Score")+
  stat_summary(fun.data = "mean_se", fun.args = list(mult = 1),size=1 ,show.legend = FALSE,geom="errorbar",width=0.1 ,position=position_dodge(width=0.5))+
  scale_y_continuous(breaks =seq(0, 15000, by = 2500))+
  scale_colour_manual(values=couleurs_poster)+
  annotation_custom(grob_SHAM)+ annotation_custom(grob_HD)+
  theme(legend.position = c(0.55,0.15),legend.background = element_rect(fill=NA),legend.title = element_blank(),
        axis.title = element_text(size=18,margin=0.1),legend.text = element_text(size=10),text=element_text(size=10))+
  annotate("text",x=c(1,2.5,4.5,6.5,8.5,10.5),y=Inf,vjust=1.5,label=c("D1","D2","D3","D4","D5","D15"),size=5)
```
### **Sous Scores** : Fortress (linéaire), Flight (ln), Bonus (ln), Mine (ln)
```{r figure_LR,echo=F,fig.height=12,fig.align = "center"}
figure_LR = ggarrange(plot_LR_fortress,plot_LR_Flight,plot_LR_Bonus,plot_LR_Mine,ncol=2,nrow=3,align = "hv")
figure_LR
```
## ANCOVA on Learning Rate by Group with Game Level as covariable
```{r ancova, include=F}
ancova_LR_Total=data_wide%>%
  anova_test(LR_LINEAR~Group+GameLevelLog) 
ancova_LR_Fortress=data_wide%>%
  anova_test(LRFortress~Group+GameLevelLog)
ancova_LR_Flight=data_wide%>%
  anova_test(LRFlight~Group+GameLevelLog) 
ancova_LR_Bonus=data_wide%>%
  anova_test(LRBonus~Group+GameLevelLog)
ancova_LR_Mine=data_wide%>%
  anova_test(LRMine~Group+GameLevelLog)
```
### **Total Score** : Linear learning Rate  
```{r ancova_totalscore, echo=FALSE,fig.align = "center"}
grob_LR=grobTree(textGrob(paste0("Group effect: p = ",toString(round(ancova_LR_Total$p[1],3)),ancova_LR_Total$`p<.05`[1]),
                          x=0.25,y=0.9,hjust=0,vjust=0),
                 text_grob(paste0("Gaming Experience effect: p = ",toString(round(ancova_LR_Total$p[2],3))),
                           x=0.25,y=0.85,hjust=0,vjust=0,face="bold")
                 ,gp=gpar(fontsize=16))

p_ancovaLR_Total=ggplot(data_wide,aes(Group,LR_LINEAR,color=Group,fill=Group,shape=Group))+
  theme_pubr()+scale_fill_manual(values=couleurs_alpha)+
  scale_color_manual(values=couleurs_poster)+
  geom_half_violin(width=0.3, position = position_nudge(x=-0.2,y=0))+geom_jitter(width=0.1)+
  stat_summary(fun.data = "mean_se", fun.args = list(mult = 1),size=1 ,show.legend = FALSE,geom="errorbar",width=0.1)+
  stat_summary(fun=mean, geom="point",size=4)+
  ylab("Learning Rate (lin) Total Score")+rremove("legend")+scale_x_discrete(labels=c("Sham","SD-tRNS","HD-tRNS"))+
  annotation_custom(grob_LR)+
  theme(axis.title=element_text(margin=0.1,size=18),text =element_text(size=16) )
p_ancovaLR_Total
```
```{r ancova_fortress, echo=FALSE}
grob_LR=grobTree(textGrob(paste0("Group effect: p = ",toString(round(ancova_LR_Fortress$p[1],3)),ancova_LR_Fortress$`p<.05`[1]),
                          x=0.25,y=0.9,hjust=0,vjust=0),
                 text_grob(paste0("Gaming Experience effect: p = ",toString(round(ancova_LR_Fortress$p[2],3))),
                           x=0.25,y=0.85,hjust=0,vjust=0,face="bold")
                 ,gp=gpar(fontsize=12))

p_ancovaLR_Fortress=ggplot(data_wide,aes(Group,LRFortress,color=Group,fill=Group,shape=Group))+
  theme_pubr()+scale_fill_manual(values=couleurs_alpha)+
  scale_color_manual(values=couleurs_poster)+
  geom_half_violin(width=0.3, position = position_nudge(x=-0.2,y=0))+geom_jitter(width=0.1)+
  stat_summary(fun.data = "mean_se", fun.args = list(mult = 1),size=1 ,show.legend = FALSE,geom="errorbar",width=0.1)+
  stat_summary(fun=mean, geom="point",size=4)+xlab("")+
  ylab("Learning Rate (lin) Fortress Score")+rremove("legend")+scale_x_discrete(labels=c("Sham","SD-tRNS","HD-tRNS"))+
  annotation_custom(grob_LR)+
  theme(axis.title=element_text(margin=0.1,size=18),text =element_text(size=14) )
```
```{r ancova_Flight, echo=FALSE}
grob_LR=grobTree(textGrob(paste0("Group effect: p = ",toString(round(ancova_LR_Flight$p[1],3)),ancova_LR_Flight$`p<.05`[1]),
                          x=0.25,y=0.9,hjust=0,vjust=0),
                 text_grob(paste0("Gaming Experience effect: p = ",toString(round(ancova_LR_Flight$p[2],3))),
                           x=0.25,y=0.85,hjust=0,vjust=0,face="bold")
                 ,gp=gpar(fontsize=12))

p_ancovaLR_Flight=ggplot(data_wide,aes(Group,LRFlight,color=Group,fill=Group,shape=Group))+
  theme_pubr()+scale_fill_manual(values=couleurs_alpha)+
  scale_color_manual(values=couleurs_poster)+
  geom_half_violin(width=0.3, position = position_nudge(x=-0.2,y=0))+geom_jitter(width=0.1)+
  stat_summary(fun.data = "mean_se", fun.args = list(mult = 1),size=1 ,show.legend = FALSE,geom="errorbar",width=0.1)+
  stat_summary(fun=mean, geom="point",size=4)+xlab("")+
  ylab("Learning Rate (ln) Flight Score")+rremove("legend")+scale_x_discrete(labels=c("Sham","SD-tRNS","HD-tRNS"))+
  annotation_custom(grob_LR)+
  theme(axis.title=element_text(margin=0.1,size=18),text =element_text(size=14) )
```
```{r ancova_Bonus, echo=FALSE}
grob_LR=grobTree(textGrob(paste0("Group effect: p = ",toString(round(ancova_LR_Bonus$p[1],3)),ancova_LR_Bonus$`p<.05`[1]),
                          x=0.25,y=0.9,hjust=0,vjust=0),
                 text_grob(paste0("Gaming Experience effect: p = ",toString(round(ancova_LR_Bonus$p[2],3))),
                           x=0.25,y=0.85,hjust=0,vjust=0,face="bold")
                 ,gp=gpar(fontsize=12))

p_ancovaLR_Bonus=ggplot(data_wide,aes(Group,LRBonus,color=Group,fill=Group,shape=Group))+
  theme_pubr()+scale_fill_manual(values=couleurs_alpha)+
  scale_color_manual(values=couleurs_poster)+
  geom_half_violin(width=0.3, position = position_nudge(x=-0.2,y=0))+geom_jitter(width=0.1)+
  stat_summary(fun.data = "mean_se", fun.args = list(mult = 1),size=1 ,show.legend = FALSE,geom="errorbar",width=0.1)+
  stat_summary(fun=mean, geom="point",size=4)+xlab("")+
  ylab("Learning Rate (ln) Bonus Score")+rremove("legend")+scale_x_discrete(labels=c("Sham","SD-tRNS","HD-tRNS"))+
  annotation_custom(grob_LR)+
  theme(axis.title=element_text(margin=0.1,size=18),text =element_text(size=14) )
```
```{r ancova_Mine, echo=FALSE}
grob_LR=grobTree(textGrob(paste0("Group effect: p = ",toString(round(ancova_LR_Mine$p[1],3)),ancova_LR_Mine$`p<.05`[1]),
                          x=0.25,y=0.9,hjust=0,vjust=0),
                 text_grob(paste0("Gaming Experience effect: p = ",toString(round(ancova_LR_Mine$p[2],3))),
                           x=0.25,y=0.85,hjust=0,vjust=0,face="bold")
                 ,gp=gpar(fontsize=12))

p_ancovaLR_Mine=ggplot(data_wide,aes(Group,LRMine,color=Group,fill=Group,shape=Group))+
  theme_pubr()+scale_fill_manual(values=couleurs_alpha)+
  scale_color_manual(values=couleurs_poster)+
  geom_half_violin(width=0.3, position = position_nudge(x=-0.2,y=0))+geom_jitter(width=0.1)+
  stat_summary(fun.data = "mean_se", fun.args = list(mult = 1),size=1 ,show.legend = FALSE,geom="errorbar",width=0.1)+
  stat_summary(fun=mean, geom="point",size=4)+xlab("")+
  ylab("Learning Rate (ln) Mine Score")+rremove("legend")+scale_x_discrete(labels=c("Sham","SD-tRNS","HD-tRNS"))+
  annotation_custom(grob_LR)+
  theme(axis.title=element_text(margin=0.1,size=14),text =element_text(size=14) )
```
```{r figure_ancova, echo=FALSE,fig.height=12,fig.align = "center"}
figure_ancova_LR = ggarrange(p_ancovaLR_Fortress,p_ancovaLR_Flight,p_ancovaLR_Bonus,p_ancovaLR_Mine,ncol=2,nrow=3,align = "hv")
figure_ancova_LR
```
## ANCOVA on Delta (Sub-Scores and Total Score)
```{r delta,include = F}
#LT:long-term, ST:short-term, RT:retention
#Total Score
ancova_total_LT = data_wide%>%
  anova_test(DeltaD1D14~Group+GameLevelLog)
ancova_total_ST = data_wide%>%
  anova_test(DeltaD1D5~Group+GameLevelLog)
ancova_totat_RT =data_wide%>%
  anova_test(DeltaD14D5~Group+GameLevelLog)
#Fortress
ancova_fortress_LT = data_wide%>%
  anova_test(DeltaD1D14Fortress~Group+GameLevelLog)
ancova_fortress_ST = data_wide%>%
  anova_test(DeltaD5D1Fortress~Group+GameLevelLog)
ancova_fortress_RT =data_wide%>%
  anova_test(DeltaD14D5Fortress~Group+GameLevelLog)
#Flight
ancova_flight_LT = data_

```